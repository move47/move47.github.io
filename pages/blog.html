<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Blog</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='../main.css'>
    <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.0/css/all.css">
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    <script src='../main.js'></script>
    <script type="text/javascript" src="js/lib/jquery-1.11.1.min.js" ></script>
    <script> 
        $(function(){ $("head").load("header.html") });
    </script>
   <script> 
     $(function(){ $("head").load("footer.html") });
   </script>
</head>
<body>
    <iframe src="./header.html" id="iFrameID" frameborder="0"  style="visibility:hidden;" onload="this.before((this.contentDocument.body||this.contentDocument).children[0]);this.remove()"></iframe>
    
    <!--body-->
    <section class="aboutme">
        <div class="about__container">
            <h2 class="section__title">Blog</h2>
            
            <div class="about-content">
                <div class="line"></div>
                <div class="about__data">
                    <div class="blog-wrapper" id="gridview">

                    </div>
                </div>
                <!-- <div id="popuparticle" class="popup">
                  <div class="popup__block">
                    <h1 class="popup__title">The my adventure in the France and photography with Tour De France</h1>
                      <div class="popupbody">
                          
                      </div>
                    <a href="#" class="popup__close">close</a>
                  </div>
              </div> -->
            </div>
        </div>
    </section>
    

    <!-------->
    <iframe id="iFrameID" frameborder="0"  style="visibility:hidden;" src="./footer.html" onload="this.before((this.contentDocument.body||this.contentDocument).children[0]);this.remove()"></iframe>

</body>
<script>

    var getJSON = function(url, callback) {
      var xhr = new XMLHttpRequest();
      xhr.open('GET', url, true);
      xhr.responseType = 'application/json';

      xhr.onload = function() {

          var status = xhr.status;

          if (status == 200) {
              callback(null, xhr.response);
          } else {
              callback(status);
          }
      };

      xhr.send();
    };

    function datefy(date){
      var parts =date.split('T')[0].split('-');
      // Please pay attention to the month (parts[1]); JavaScript counts months from 0:
      // January - 0, February - 1, etc.
      var mydate = new Date(parts[0], parts[1] - 1, parts[2]); 
      return mydate.toDateString()
    }
    function populate(data){
        const container = document.getElementById('gridview');

        data.forEach((result, idx) => {
        // Create card element
        const card = document.createElement('div');
        card.classList = 'card-body';

        // Construct card content
        const content = `<div class="blog-wrap">
          <div class="blog-card">
            <div class="blog-content">
              <div class="blog-info">
                <h5 class="blog-date" style="margin-left:105px">${datefy(result.date)}</h5>
                
              </div>
              
              
              <a href="../blogs/${result.name+'.html'}"  id="${result.name+'.markdown'}"" onclick="showModal(${result.name+'.markdown'},${result.title});" class="btn small"><h3 class="title-sm" >${result.title}</h3></a>
              
            </div>

        </div>
        `;

        // Append newyly created card element to the container
        container.innerHTML += content;
        })
    }
    
    getJSON('../posts.json',  function(err, data) {

      if (err != null) {
      console.error(err);
      } else {

      var text = data
      var arr=JSON.parse(text);
      console.log(text);

      var f= arr.files
      //data1 = ['user1', 'user2', 'user3'];
      //update_list(data1)
      populate(f)

      // $(".mypanel").append(tree(f));
      
      }
    });
 
    
   
</script>
</html>